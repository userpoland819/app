(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7978],{7978:(I,Z,m)=>{"use strict";m.r(Z),m.d(Z,{PagePageModule:()=>j});var S=m(6895),b=m(4006),t=m(9972),e=m(2658),n=m(5861),s=m(1808),o=m(4038),a=m(8407),i=(m(9529),m(4650)),u=m(1481),d=m(4662),_=m(3646),f=m(1006),c=m(9383);function v(h,C){1&h&&(i.TgZ(0,"div",4),i._UZ(1,"ion-spinner",5),i.qZA())}function M(h,C){1&h&&(i.TgZ(0,"div",9),i._UZ(1,"img",10),i.TgZ(2,"div")(3,"p"),i._uU(4),i.ALo(5,"translate"),i.qZA(),i.TgZ(6,"a",11),i._uU(7),i.ALo(8,"translate"),i.qZA()()()),2&h&&(i.xp6(4),i.Oqu(i.lcZ(5,2,"DEMO")),i.xp6(3),i.hij("",i.lcZ(8,4,"DEMO_BUY"),": www.codecanyon.net"))}function O(h,C){if(1&h&&i._UZ(0,"div",17),2&h){const l=i.oxw().$implicit;i.Q6J("innerHTML",l.content,i.oJD)}}const x=function(h,C){return[h,C]};function w(h,C){if(1&h&&(i.TgZ(0,"ion-card",18)(1,"ion-card-content",19),i._UZ(2,"ion-label",17)(3,"p",17),i.qZA(),i._UZ(4,"ion-ripple-effect"),i.qZA()),2&h){const l=i.oxw().$implicit,y=i.oxw(2);i.Jzz("background-image: url('",null==l.randomPost?null:l.randomPost.image,"');"),i.Q6J("routerLink",i.WLB(6,x,y.postsSlug,null==l.randomPost?null:l.randomPost.id)),i.xp6(2),i.Q6J("innerHTML",null==l.randomPost?null:l.randomPost.title,i.oJD),i.xp6(1),i.Q6J("innerHTML",null==l.randomPost?null:l.randomPost.content,i.oJD)}}function G(h,C){if(1&h&&(i.TgZ(0,"div",25)(1,"ion-label"),i._UZ(2,"ion-icon",27),i._uU(3),i.qZA()()),2&h){const l=i.oxw().$implicit;i.xp6(2),i.Jzz("color: rgba(",null==l?null:l.category.color,", 1)"),i.s9C("name",null==l?null:l.category.icon),i.xp6(1),i.Oqu(null==l?null:l.category.title)}}function A(h,C){if(1&h&&(i.TgZ(0,"ion-col",21)(1,"ion-card",22),i._UZ(2,"ion-img",23),i.TgZ(3,"div",24)(4,"div",25)(5,"ion-label"),i._uU(6),i.qZA()(),i.YNc(7,G,4,5,"div",26),i.qZA(),i.TgZ(8,"ion-card-content",19),i._UZ(9,"ion-label",17),i.qZA(),i._UZ(10,"ion-ripple-effect"),i.qZA()()),2&h){const l=C.$implicit,y=i.oxw(4);i.xp6(1),i.Q6J("routerLink",i.WLB(6,x,y.postsSlug,null==l?null:l.id)),i.xp6(1),i.s9C("src",null==l?null:l.image),i.s9C("alt",null==l?null:l.title),i.xp6(4),i.Oqu(null==l?null:l.date),i.xp6(1),i.Q6J("ngIf",y.cats.length>1),i.xp6(2),i.Q6J("innerHTML",null==l?null:l.title,i.oJD)}}function B(h,C){if(1&h&&(i.TgZ(0,"ion-row"),i.YNc(1,A,11,9,"ion-col",20),i.qZA()),2&h){const l=i.oxw().$implicit;i.xp6(1),i.Q6J("ngForOf",null==l?null:l.posts)}}function U(h,C){if(1&h&&(i.TgZ(0,"div",25)(1,"ion-label"),i._UZ(2,"ion-icon",27),i._uU(3),i.qZA()()),2&h){const l=i.oxw(5);i.xp6(2),i.Jzz("color: rgba(",l.mapPost.category.color,", 1)"),i.s9C("name",l.mapPost.category.icon),i.xp6(1),i.Oqu(l.mapPost.category.title)}}function z(h,C){if(1&h&&(i.TgZ(0,"ion-card",30),i._UZ(1,"ion-img",23),i.TgZ(2,"div",24)(3,"div",25)(4,"ion-label"),i._uU(5),i.qZA()(),i.YNc(6,U,4,5,"div",26),i.qZA(),i.TgZ(7,"ion-card-content",19),i._UZ(8,"ion-label",17),i.qZA(),i._UZ(9,"ion-ripple-effect"),i.qZA()),2&h){const l=i.oxw(4);i.Q6J("routerLink",i.WLB(6,x,l.postsSlug,null==l.mapPost?null:l.mapPost.id)),i.xp6(1),i.s9C("src",l.mapPost.image),i.s9C("alt",l.mapPost.title),i.xp6(4),i.Oqu(l.mapPost.date),i.xp6(1),i.Q6J("ngIf",l.cats.length>1),i.xp6(2),i.Q6J("innerHTML",null==l.mapPost?null:l.mapPost.title,i.oJD)}}function E(h,C){if(1&h&&(i.TgZ(0,"div",28),i.YNc(1,z,10,9,"ion-card",29),i._UZ(2,"app-map"),i.qZA()),2&h){const l=i.oxw(3);i.xp6(1),i.Q6J("ngIf",l.service.showSelected)}}function N(h,C){if(1&h&&(i.TgZ(0,"div"),i.YNc(1,O,1,1,"div",12),i.YNc(2,w,5,9,"ion-card",13),i.TgZ(3,"ion-grid",14),i.YNc(4,B,2,1,"ion-row",15),i.qZA(),i.YNc(5,E,3,1,"div",16),i.qZA()),2&h){const l=C.$implicit;i.xp6(1),i.Q6J("ngIf",l.content),i.xp6(1),i.Q6J("ngIf",l.randomPost),i.xp6(2),i.Q6J("ngIf",l.posts),i.xp6(1),i.Q6J("ngIf","MAP_POSTS"==l.key)}}const D=function(h){return{"sticky-margin":h}};function H(h,C){if(1&h&&(i.TgZ(0,"div",6),i.YNc(1,M,9,6,"div",7),i.YNc(2,N,6,4,"div",8),i.qZA()),2&h){const l=i.oxw();i.Q6J("ngClass",i.VKq(3,D,l.service.settings.stickyHeader)),i.xp6(1),i.Q6J("ngIf",l.service.settings.demo),i.xp6(1),i.Q6J("ngForOf",l.page)}}const F=function(h){return{sticky:h}},R=[{path:"",component:(()=>{class h{constructor(l,y,k,p){this.service=l,this.domSanitizer=y,this.route=k,this.router=p,this.loading=!0,this.postsSlug=s.D.postsSlug,this.latestPosts=[],this.page=[],this.pageData=[],this.cats=[]}ngOnInit(){var l=this;return(0,n.Z)(function*(){l.getPage()})()}ionViewDidEnter(){setTimeout(()=>{this.setColors()},1e3),setTimeout(()=>{this.setColors()},2e3)}setColors(){this.service.isApp&&this.service.updateColors()}getPage(){var l=this;return(0,n.Z)(function*(){let y=l.route.snapshot.paramMap.get("slug");if(null==y){const k=yield(0,o.IO)((0,o.hJ)((0,o.ad)(),"pages"),(0,o.Xo)("setAsHome","desc"),(0,o.b9)(1));(yield(0,o.PL)(k)).forEach(g=>{l.pageData=g.data(),l.getLatestPosts()})}else{const k=(0,o.JU)((0,o.ad)(),"pages",y),p=yield(0,o.QT)(k);null==p.data()?l.router.navigate(["/404"]):(l.pageData=p.data(),l.getLatestPosts())}})()}getLatestPosts(){var l=this;return(0,n.Z)(function*(){l.latestPosts=[];const y=yield(0,o.IO)((0,o.hJ)((0,o.ad)(),"posts"),(0,o.Xo)("created","desc"));(yield(0,o.PL)(y)).forEach(p=>{let g=p.data();if(g.id=p.id,g.date=l.service.formatDate(new Date(Number(g.created))),l.cats.find(P=>P.title===g.category.title))l.cats.find(P=>P.title===g.category.title).data.push(g);else{let P=g.category;P.data=[],P.data.push(g),l.cats.push(P)}l.latestPosts.push(g)}),l.pageData.blocks.forEach(p=>{let g=p;"LATEST_POSTS"==p.post?g.posts=l.latestPosts.slice(0,4):"MOSTLIKED_POSTS"==p.post?g.posts=l.latestPosts.sort((P,T)=>P.likes-T.likes).reverse().slice(0,4):"ALL_POSTS"==p.post?g.posts=l.latestPosts:"RANDOM_POST"==p.post?g.randomPost=l.latestPosts[Object.keys(l.latestPosts)[Math.floor(Math.random()*Object.keys(l.latestPosts).length)]]:"MAP_POSTS"==p.key?setTimeout(()=>{l.service.loadMap("homeMap"),setTimeout(()=>{l.cats.forEach(P=>{l.addPostsClusters(P)})},500)},1500):"TEXT_EDITOR"==p.key&&(g.content=l.domSanitizer.bypassSecurityTrustHtml(g.content)),l.page.push(g)}),l.loading=!1})()}addPostsClusters(l){l.markers=new a.MarkerClusterGroup({iconCreateFunction:function(p){p.getAllChildMarkers();var P='<div style="margin: 0px 0px 7px 0px;"><ion-icon name="'+l.icon+'" style="background-color: rgba('+l.color+", 1); color: #ffffff; font-size: 24px; margin: 0px; padding: 4px; border-radius: var(--ion-border-radius); box-shadow: 0px 0px 0px 5px rgba("+l.color+', 0.4);"></ion-icon><ion-badge class="cluster-badge">'+p.getChildCount()+"</ion-badge></div>";return a.divIcon({html:P,className:"mycluster",iconSize:a.point(32,32)})},spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,maxClusterRadius:120,chunkedLoading:!0,spiderLegPolylineOptions:{weight:1.5,color:"var(--ion-main-color)",opacity:.5}});let k=[];for(let p=0;p<l.data.length;p++){let g=l.data[p],P=this.service.mapMarker(l.color,l.icon),T=(0,a.divIcon)({html:P}),Q=a.marker([g.latitude,g.longitude],{icon:T}).on("click",()=>this.selectPostMarker(g));k.push(Q)}l.markers.addLayers(k),this.service.map.addLayer(l.markers)}selectPostMarker(l){this.mapPost=l,this.service.showSelected=!0}madeRefresh(l){this.service.isApp?(this.latestPosts=[],this.cats=[],setTimeout(()=>{this.getLatestPosts()},200),setTimeout(()=>{l.target.complete()},400)):location.reload()}}return h.\u0275fac=function(l){return new(l||h)(i.Y36(s.t),i.Y36(u.H7),i.Y36(e.gz),i.Y36(e.F0))},h.\u0275cmp=i.Xpm({type:h,selectors:[["app-page"]],decls:7,vars:5,consts:[["slot","fixed","id","refresher",2,"padding","34px 0px 120px 0px","margin-top","0px",3,"ionRefresh"],[3,"ngClass"],["class","loading",4,"ngIf"],["class","wrapper-big",3,"ngClass",4,"ngIf"],[1,"loading"],["name","lines"],[1,"wrapper-big",3,"ngClass"],["class","demo",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"demo"],["src","https://s3.envato.com/files/388913171/img.png"],["href","https://codecanyon.net/user/ionicpoet/portfolio","target","_blank"],[3,"innerHTML",4,"ngIf"],["class","big-card ion-activatable ripple-parent",3,"routerLink","style",4,"ngIf"],[2,"margin","0px"],[4,"ngIf"],["style","position: relative; margin: 0px 10px;",4,"ngIf"],[3,"innerHTML"],[1,"big-card","ion-activatable","ripple-parent",3,"routerLink"],[1,"text-space"],["sizeLg","3","sizeMd","6","sizeXs","6","style","padding: 6px;",4,"ngFor","ngForOf"],["sizeLg","3","sizeMd","6","sizeXs","6",2,"padding","6px"],[1,"post-card","ion-activatable","ripple-parent",3,"routerLink"],["loading","lazy",1,"image-space",3,"src","alt"],[1,"chip-space"],[1,"postChip"],["class","postChip",4,"ngIf"],[3,"name"],[2,"position","relative","margin","0px 10px"],["class","post-card post-card-map ion-activatable ripple-parent",3,"routerLink",4,"ngIf"],[1,"post-card","post-card-map","ion-activatable","ripple-parent",3,"routerLink"]],template:function(l,y){1&l&&(i.TgZ(0,"ion-content")(1,"ion-refresher",0),i.NdJ("ionRefresh",function(p){return y.madeRefresh(p)}),i._UZ(2,"ion-refresher-content"),i.qZA(),i._UZ(3,"app-header",1),i.YNc(4,v,2,0,"div",2),i.YNc(5,H,3,5,"div",3),i._UZ(6,"app-footer"),i.qZA()),2&l&&(i.xp6(3),i.Q6J("ngClass",i.VKq(3,F,y.service.settings.stickyHeader)),i.xp6(1),i.Q6J("ngIf",y.loading),i.xp6(1),i.Q6J("ngIf",!y.loading))},dependencies:[S.mk,S.sg,S.O5,t.PM,t.FN,t.wI,t.W2,t.jY,t.gu,t.Xz,t.Q$,t.nJ,t.Wo,t.H$,t.Nd,t.PQ,t.YI,e.rH,d.c,_.G,f.G,c.X$],styles:['.loading[_ngcontent-%COMP%]{text-align:center}.loading[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{width:4vh;padding:50vh 0px;color:rgba(var(--ion-main-color),1);opacity:.5}.big-card[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background-color:#000;opacity:.1;z-index:2}.big-card[_ngcontent-%COMP%]{--ripple-color: var(--ion-main-color) !important;padding:0;margin:17px 10px 10px;box-shadow:none;border-radius:var(--ion-border-radius);box-shadow:0 4px 15px var(--ion-box-shadow);height:462px;background-repeat:no-repeat;background-size:cover;background-position:center}.big-card[_ngcontent-%COMP%]   .text-space[_ngcontent-%COMP%]{text-align:left;position:absolute;left:4px;bottom:4px;color:#fff;border-radius:var(--ion-border-radius);z-index:10}@media (min-width: 1024px){.big-card[_ngcontent-%COMP%]   .text-space[_ngcontent-%COMP%]{width:40%}}@media (min-width: 768px) and (max-width: 1024px){.big-card[_ngcontent-%COMP%]   .text-space[_ngcontent-%COMP%]{width:calc(100% - 8px)}}@media (max-width: 767px){.big-card[_ngcontent-%COMP%]   .text-space[_ngcontent-%COMP%]{width:calc(100% - 8px)}}.big-card[_ngcontent-%COMP%]   .text-space[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:4vh;font-weight:700;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;line-clamp:2}.big-card[_ngcontent-%COMP%]   .text-space[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:2vh;font-weight:400;padding-top:6px;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;line-clamp:2}']}),h})()}];let J=(()=>{class h{}return h.\u0275fac=function(l){return new(l||h)},h.\u0275mod=i.oAB({type:h}),h.\u0275inj=i.cJS({imports:[e.Bz.forChild(R),e.Bz]}),h})();var q=m(5642);let j=(()=>{class h{}return h.\u0275fac=function(l){return new(l||h)},h.\u0275mod=i.oAB({type:h}),h.\u0275inj=i.cJS({imports:[S.ez,b.u5,t.Pc,J,c.aw,q.K]}),h})()},9529:function(I,Z){!function(m){"use strict";var S=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(t){L.Util.setOptions(this,t),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var e=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,e?this._withAnimation:this._noAnimation),this._markerCluster=e?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(t){if(t instanceof L.LayerGroup)return this.addLayers([t]);if(!t.getLatLng)return this._nonPointGroup.addLayer(t),this.fire("layeradd",{layer:t}),this;if(!this._map)return this._needsClustering.push(t),this.fire("layeradd",{layer:t}),this;if(this.hasLayer(t))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(t,this._maxZoom),this.fire("layeradd",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var e=t,n=this._zoom;if(t.__parent)for(;e.__parent._zoom>=n;)e=e.__parent;return this._currentShownBounds.contains(e.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(t,e):this._animationAddLayerNonAnimated(t,e)),this},removeLayer:function(t){return t instanceof L.LayerGroup?this.removeLayers([t]):t.getLatLng?this._map?t.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(t)),this._removeLayer(t,!0),this.fire("layerremove",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),t.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(t)&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,t)&&this.hasLayer(t)&&this._needsRemoving.push({layer:t,latlng:t._latlng}),this.fire("layerremove",{layer:t}),this):(this._nonPointGroup.removeLayer(t),this.fire("layerremove",{layer:t}),this)},addLayers:function(t,e){if(!L.Util.isArray(t))return this.addLayer(t);var _,n=this._featureGroup,s=this._nonPointGroup,o=this.options.chunkedLoading,a=this.options.chunkInterval,r=this.options.chunkProgress,i=t.length,u=0,d=!0;if(this._map){var f=(new Date).getTime(),c=L.bind(function(){var M=(new Date).getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();u<i&&!(o&&u%200==0&&(new Date).getTime()-M>a);u++)if((_=t[u])instanceof L.LayerGroup)d&&(t=t.slice(),d=!1),this._extractNonGroupLayers(_,t),i=t.length;else if(_.getLatLng){if(!this.hasLayer(_)&&(this._addLayer(_,this._maxZoom),e||this.fire("layeradd",{layer:_}),_.__parent&&2===_.__parent.getChildCount())){var x=_.__parent.getAllChildMarkers();n.removeLayer(x[0]===_?x[1]:x[0])}}else s.addLayer(_),e||this.fire("layeradd",{layer:_});r&&r(u,i,(new Date).getTime()-f),u===i?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(c,this.options.chunkDelay)},this);c()}else for(var v=this._needsClustering;u<i;u++)(_=t[u])instanceof L.LayerGroup?(d&&(t=t.slice(),d=!1),this._extractNonGroupLayers(_,t),i=t.length):_.getLatLng?this.hasLayer(_)||v.push(_):s.addLayer(_);return this},removeLayers:function(t){var e,n,s=t.length,o=this._featureGroup,a=this._nonPointGroup,r=!0;if(!this._map){for(e=0;e<s;e++)(n=t[e])instanceof L.LayerGroup?(r&&(t=t.slice(),r=!1),this._extractNonGroupLayers(n,t),s=t.length):(this._arraySplice(this._needsClustering,n),a.removeLayer(n),this.hasLayer(n)&&this._needsRemoving.push({layer:n,latlng:n._latlng}),this.fire("layerremove",{layer:n}));return this}if(this._unspiderfy){this._unspiderfy();var i=t.slice(),u=s;for(e=0;e<u;e++)(n=i[e])instanceof L.LayerGroup?(this._extractNonGroupLayers(n,i),u=i.length):this._unspiderfyLayer(n)}for(e=0;e<s;e++)(n=t[e])instanceof L.LayerGroup?(r&&(t=t.slice(),r=!1),this._extractNonGroupLayers(n,t),s=t.length):n.__parent?(this._removeLayer(n,!0,!0),this.fire("layerremove",{layer:n}),o.hasLayer(n)&&(o.removeLayer(n),n.clusterShow&&n.clusterShow())):(a.removeLayer(n),this.fire("layerremove",{layer:n}));return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(t){t.off(this._childMarkerEventHandlers,this),delete t.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var t=new L.LatLngBounds;this._topClusterLevel&&t.extend(this._topClusterLevel._bounds);for(var e=this._needsClustering.length-1;e>=0;e--)t.extend(this._needsClustering[e].getLatLng());return t.extend(this._nonPointGroup.getBounds()),t},eachLayer:function(t,e){var o,a,r,n=this._needsClustering.slice(),s=this._needsRemoving;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(n),a=n.length-1;a>=0;a--){for(o=!0,r=s.length-1;r>=0;r--)if(s[r].layer===n[a]){o=!1;break}o&&t.call(e,n[a])}this._nonPointGroup.eachLayer(t,e)},getLayers:function(){var t=[];return this.eachLayer(function(e){t.push(e)}),t},getLayer:function(t){var e=null;return t=parseInt(t,10),this.eachLayer(function(n){L.stamp(n)===t&&(e=n)}),e},hasLayer:function(t){if(!t)return!1;var e,n=this._needsClustering;for(e=n.length-1;e>=0;e--)if(n[e]===t)return!0;for(e=(n=this._needsRemoving).length-1;e>=0;e--)if(n[e].layer===t)return!1;return!(!t.__parent||t.__parent._group!==this)||this._nonPointGroup.hasLayer(t)},zoomToShowLayer:function(t,e){var n=this._map;"function"!=typeof e&&(e=function(){});var s=function(){(n.hasLayer(t)||n.hasLayer(t.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",s,this),this.off("animationend",s,this),n.hasLayer(t)?e():t.__parent._icon&&(this.once("spiderfied",e,this),t.__parent.spiderfy()))};t._icon&&this._map.getBounds().contains(t.getLatLng())?e():t.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",s,this),this._map.panTo(t.getLatLng())):(this._map.on("moveend",s,this),this.on("animationend",s,this),t.__parent.zoomToBounds())},onAdd:function(t){var e,n,s;if(this._map=t,!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(t),this._nonPointGroup.addTo(t),this._gridClusters||this._generateInitialClusters(),this._maxLat=t.options.crs.projection.MAX_LATITUDE,e=0,n=this._needsRemoving.length;e<n;e++)(s=this._needsRemoving[e]).newlatlng=s.layer._latlng,s.layer._latlng=s.latlng;for(e=0,n=this._needsRemoving.length;e<n;e++)this._removeLayer((s=this._needsRemoving[e]).layer,!0),s.layer._latlng=s.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),n=this._needsClustering,this._needsClustering=[],this.addLayers(n,!0)},onRemove:function(t){t.off("zoomend",this._zoomEnd,this),t.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(t){for(var e=t;e&&!e._icon;)e=e.__parent;return e||null},_arraySplice:function(t,e){for(var n=t.length-1;n>=0;n--)if(t[n]===e)return t.splice(n,1),!0},_removeFromGridUnclustered:function(t,e){for(var n=this._map,s=this._gridUnclustered,o=Math.floor(this._map.getMinZoom());e>=o&&s[e].removeObject(t,n.project(t.getLatLng(),e));e--);},_childMarkerDragStart:function(t){t.target.__dragStart=t.target._latlng},_childMarkerMoved:function(t){if(!this._ignoreMove&&!t.target.__dragStart){var e=t.target._popup&&t.target._popup.isOpen();this._moveChild(t.target,t.oldLatLng,t.latlng),e&&t.target.openPopup()}},_moveChild:function(t,e,n){t._latlng=e,this.removeLayer(t),t._latlng=n,this.addLayer(t)},_childMarkerDragEnd:function(t){var e=t.target.__dragStart;delete t.target.__dragStart,e&&this._moveChild(t.target,e,t.target._latlng)},_removeLayer:function(t,e,n){var s=this._gridClusters,o=this._gridUnclustered,a=this._featureGroup,r=this._map,i=Math.floor(this._map.getMinZoom());e&&this._removeFromGridUnclustered(t,this._maxZoom);var _,u=t.__parent;for(this._arraySplice(u._markers,t);u&&(u._childCount--,u._boundsNeedUpdate=!0,!(u._zoom<i));)e&&u._childCount<=1?(_=u._markers[0]===t?u._markers[1]:u._markers[0],s[u._zoom].removeObject(u,r.project(u._cLatLng,u._zoom)),o[u._zoom].addObject(_,r.project(_.getLatLng(),u._zoom)),this._arraySplice(u.__parent._childClusters,u),u.__parent._markers.push(_),_.__parent=u.__parent,u._icon&&(a.removeLayer(u),n||a.addLayer(_))):u._iconNeedsUpdate=!0,u=u.__parent;delete t.__parent},_isOrIsParent:function(t,e){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},fire:function(t,e,n){if(e&&e.layer instanceof L.MarkerCluster){if(e.originalEvent&&this._isOrIsParent(e.layer._icon,e.originalEvent.relatedTarget))return;t="cluster"+t}L.FeatureGroup.prototype.fire.call(this,t,e,n)},listens:function(t,e){return L.FeatureGroup.prototype.listens.call(this,t,e)||L.FeatureGroup.prototype.listens.call(this,"cluster"+t,e)},_defaultIconCreateFunction:function(t){var e=t.getChildCount(),n=" marker-cluster-";return new L.DivIcon({html:"<div><span>"+e+"</span></div>",className:"marker-cluster"+(n+=e<10?"small":e<100?"medium":"large"),iconSize:new L.Point(40,40)})},_bindEvents:function(){var t=this._map,n=this.options.showCoverageOnHover;(this.options.spiderfyOnMaxZoom||this.options.zoomToBoundsOnClick||this.options.spiderfyOnEveryZoom)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),n&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),t.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(t){var e=t.layer,n=e;if("clusterkeypress"!==t.type||!t.originalEvent||13===t.originalEvent.keyCode){for(;1===n._childClusters.length;)n=n._childClusters[0];n._zoom===this._maxZoom&&n._childCount===e._childCount&&this.options.spiderfyOnMaxZoom?e.spiderfy():this.options.zoomToBoundsOnClick&&e.zoomToBounds(),this.options.spiderfyOnEveryZoom&&e.spiderfy(),t.originalEvent&&13===t.originalEvent.keyCode&&this._map._container.focus()}},_showCoverage:function(t){var e=this._map;this._inZoomAnimation||(this._shownPolygon&&e.removeLayer(this._shownPolygon),t.layer.getChildCount()>2&&t.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(t.layer.getConvexHull(),this.options.polygonOptions),e.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var e=this.options.showCoverageOnHover,o=this._map;(this.options.spiderfyOnMaxZoom||this.options.zoomToBoundsOnClick||this.options.spiderfyOnEveryZoom)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),e&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),o.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var t=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),t),this._currentShownBounds=t}},_generateInitialClusters:function(){var t=Math.ceil(this._map.getMaxZoom()),e=Math.floor(this._map.getMinZoom()),n=this.options.maxClusterRadius,s=n;"function"!=typeof n&&(s=function(){return n}),null!==this.options.disableClusteringAtZoom&&(t=this.options.disableClusteringAtZoom-1),this._maxZoom=t,this._gridClusters={},this._gridUnclustered={};for(var o=t;o>=e;o--)this._gridClusters[o]=new L.DistanceGrid(s(o)),this._gridUnclustered[o]=new L.DistanceGrid(s(o));this._topClusterLevel=new this._markerCluster(this,e-1)},_addLayer:function(t,e){var a,r,n=this._gridClusters,s=this._gridUnclustered,o=Math.floor(this._map.getMinZoom());for(this.options.singleMarkerMode&&this._overrideMarkerIcon(t),t.on(this._childMarkerEventHandlers,this);e>=o;e--){a=this._map.project(t.getLatLng(),e);var i=n[e].getNearObject(a);if(i)return i._addChild(t),void(t.__parent=i);if(i=s[e].getNearObject(a)){var u=i.__parent;u&&this._removeLayer(i,!1);var d=new this._markerCluster(this,e,i,t);n[e].addObject(d,this._map.project(d._cLatLng,e)),i.__parent=d,t.__parent=d;var _=d;for(r=e-1;r>u._zoom;r--)_=new this._markerCluster(this,r,_),n[r].addObject(_,this._map.project(i.getLatLng(),r));return u._addChild(_),void this._removeFromGridUnclustered(i,e)}s[e].addObject(t,a)}this._topClusterLevel._addChild(t),t.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(t){t instanceof L.MarkerCluster&&t._iconNeedsUpdate&&t._updateIcon()})},_enqueue:function(t){this._queue.push(t),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var t=0;t<this._queue.length;t++)this._queue[t].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var t=Math.round(this._map._zoom);this._processQueue(),this._zoom<t&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,t)):this._zoom>t?(this._animationStart(),this._animationZoomOut(this._zoom,t)):this._moveEnd()},_getExpandedVisibleBounds:function(){return this.options.removeOutsideVisibleBounds?L.Browser.mobile?this._checkBoundsMaxLat(this._map.getBounds()):this._checkBoundsMaxLat(this._map.getBounds().pad(1)):this._mapBoundsInfinite},_checkBoundsMaxLat:function(t){var e=this._maxLat;return void 0!==e&&(t.getNorth()>=e&&(t._northEast.lat=1/0),t.getSouth()<=-e&&(t._southWest.lat=-1/0)),t},_animationAddLayerNonAnimated:function(t,e){if(e===t)this._featureGroup.addLayer(t);else if(2===e._childCount){e._addToMap();var n=e.getAllChildMarkers();this._featureGroup.removeLayer(n[0]),this._featureGroup.removeLayer(n[1])}else e._updateIcon()},_extractNonGroupLayers:function(t,e){var o,n=t.getLayers(),s=0;for(e=e||[];s<n.length;s++)(o=n[s])instanceof L.LayerGroup?this._extractNonGroupLayers(o,e):e.push(o);return e},_overrideMarkerIcon:function(t){return t.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[t]}})}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(t,e){this._animationAddLayerNonAnimated(t,e)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(t,e){var a,n=this._getExpandedVisibleBounds(),s=this._featureGroup,o=Math.floor(this._map.getMinZoom());this._ignoreMove=!0,this._topClusterLevel._recursively(n,t,o,function(r){var d,i=r._latlng,u=r._markers;for(n.contains(i)||(i=null),r._isSingleParent()&&t+1===e?(s.removeLayer(r),r._recursivelyAddChildrenToMap(null,e,n)):(r.clusterHide(),r._recursivelyAddChildrenToMap(i,e,n)),a=u.length-1;a>=0;a--)n.contains((d=u[a])._latlng)||s.removeLayer(d)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(n,e),s.eachLayer(function(r){!(r instanceof L.MarkerCluster)&&r._icon&&r.clusterShow()}),this._topClusterLevel._recursively(n,t,e,function(r){r._recursivelyRestoreChildPositions(e)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(n,t,o,function(r){s.removeLayer(r),r.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(t,e){this._animationZoomOutSingle(this._topClusterLevel,t-1,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t,this._getExpandedVisibleBounds())},_animationAddLayer:function(t,e){var n=this,s=this._featureGroup;s.addLayer(t),e!==t&&(e._childCount>2?(e._updateIcon(),this._forceLayout(),this._animationStart(),t._setPos(this._map.latLngToLayerPoint(e.getLatLng())),t.clusterHide(),this._enqueue(function(){s.removeLayer(t),t.clusterShow(),n._animationEnd()})):(this._forceLayout(),n._animationStart(),n._animationZoomOutSingle(e,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(t,e,n){var s=this._getExpandedVisibleBounds(),o=Math.floor(this._map.getMinZoom());t._recursivelyAnimateChildrenInAndAddSelfToMap(s,o,e+1,n);var a=this;this._forceLayout(),t._recursivelyBecomeVisible(s,n),this._enqueue(function(){if(1===t._childCount){var r=t._markers[0];this._ignoreMove=!0,r.setLatLng(r.getLatLng()),this._ignoreMove=!1,r.clusterShow&&r.clusterShow()}else t._recursively(s,n,o,function(i){i._recursivelyRemoveChildrenFromMap(s,o,e+1)});a._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(t){return new L.MarkerClusterGroup(t)};var b=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(t,e,n,s){L.Marker.prototype.initialize.call(this,n?n._cLatLng||n.getLatLng():new L.LatLng(0,0),{icon:this,pane:t.options.clusterPane}),this._group=t,this._zoom=e,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,n&&this._addChild(n),s&&this._addChild(s)},getAllChildMarkers:function(t,e){t=t||[];for(var n=this._childClusters.length-1;n>=0;n--)this._childClusters[n].getAllChildMarkers(t,e);for(var s=this._markers.length-1;s>=0;s--)e&&this._markers[s].__dragStart||t.push(this._markers[s]);return t},getChildCount:function(){return this._childCount},zoomToBounds:function(t){for(var r,e=this._childClusters.slice(),n=this._group._map,s=n.getBoundsZoom(this._bounds),o=this._zoom+1,a=n.getZoom();e.length>0&&s>o;){o++;var i=[];for(r=0;r<e.length;r++)i=i.concat(e[r]._childClusters);e=i}s>o?this._group._map.setView(this._latlng,o):s<=a?this._group._map.setView(this._latlng,a+1):this._group._map.fitBounds(this._bounds,t)},getBounds:function(){var t=new L.LatLngBounds;return t.extend(this._bounds),t},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(t,e){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(t),t instanceof L.MarkerCluster?(e||(this._childClusters.push(t),t.__parent=this),this._childCount+=t._childCount):(e||this._markers.push(t),this._childCount++),this.__parent&&this.__parent._addChild(t,!0)},_setClusterCenter:function(t){this._cLatLng||(this._cLatLng=t._cLatLng||t._latlng)},_resetBounds:function(){var t=this._bounds;t._southWest&&(t._southWest.lat=1/0,t._southWest.lng=1/0),t._northEast&&(t._northEast.lat=-1/0,t._northEast.lng=-1/0)},_recalculateBounds:function(){var a,r,i,u,t=this._markers,e=this._childClusters,n=0,s=0,o=this._childCount;if(0!==o){for(this._resetBounds(),a=0;a<t.length;a++)this._bounds.extend(i=t[a]._latlng),n+=i.lat,s+=i.lng;for(a=0;a<e.length;a++)(r=e[a])._boundsNeedUpdate&&r._recalculateBounds(),this._bounds.extend(r._bounds),n+=(i=r._wLatLng).lat*(u=r._childCount),s+=i.lng*u;this._latlng=this._wLatLng=new L.LatLng(n/o,s/o),this._boundsNeedUpdate=!1}},_addToMap:function(t){t&&(this._backupLatlng=this._latlng,this.setLatLng(t)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(t,e,n){this._recursively(t,this._group._map.getMinZoom(),n-1,function(s){var a,r,o=s._markers;for(a=o.length-1;a>=0;a--)(r=o[a])._icon&&(r._setPos(e),r.clusterHide())},function(s){var a,r,o=s._childClusters;for(a=o.length-1;a>=0;a--)(r=o[a])._icon&&(r._setPos(e),r.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(t,e,n,s){this._recursively(t,s,e,function(o){o._recursivelyAnimateChildrenIn(t,o._group._map.latLngToLayerPoint(o.getLatLng()).round(),n),o._isSingleParent()&&n-1===s?(o.clusterShow(),o._recursivelyRemoveChildrenFromMap(t,e,n)):o.clusterHide(),o._addToMap()})},_recursivelyBecomeVisible:function(t,e){this._recursively(t,this._group._map.getMinZoom(),e,null,function(n){n.clusterShow()})},_recursivelyAddChildrenToMap:function(t,e,n){this._recursively(n,this._group._map.getMinZoom()-1,e,function(s){if(e!==s._zoom)for(var o=s._markers.length-1;o>=0;o--){var a=s._markers[o];n.contains(a._latlng)&&(t&&(a._backupLatlng=a.getLatLng(),a.setLatLng(t),a.clusterHide&&a.clusterHide()),s._group._featureGroup.addLayer(a))}},function(s){s._addToMap(t)})},_recursivelyRestoreChildPositions:function(t){for(var e=this._markers.length-1;e>=0;e--){var n=this._markers[e];n._backupLatlng&&(n.setLatLng(n._backupLatlng),delete n._backupLatlng)}if(t-1===this._zoom)for(var s=this._childClusters.length-1;s>=0;s--)this._childClusters[s]._restorePosition();else for(var o=this._childClusters.length-1;o>=0;o--)this._childClusters[o]._recursivelyRestoreChildPositions(t)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(t,e,n,s){var o,a;this._recursively(t,e-1,n-1,function(r){for(a=r._markers.length-1;a>=0;a--)o=r._markers[a],(!s||!s.contains(o._latlng))&&(r._group._featureGroup.removeLayer(o),o.clusterShow&&o.clusterShow())},function(r){for(a=r._childClusters.length-1;a>=0;a--)o=r._childClusters[a],(!s||!s.contains(o._latlng))&&(r._group._featureGroup.removeLayer(o),o.clusterShow&&o.clusterShow())})},_recursively:function(t,e,n,s,o){var i,u,a=this._childClusters,r=this._zoom;if(e<=r&&(s&&s(this),o&&r===n&&o(this)),r<e||r<n)for(i=a.length-1;i>=0;i--)(u=a[i])._boundsNeedUpdate&&u._recalculateBounds(),t.intersects(u._bounds)&&u._recursively(t,e,n,s,o)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var t=this.options.opacity;return this.setOpacity(0),this.options.opacity=t,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(t){this._cellSize=t,this._sqCellSize=t*t,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(t,e){var n=this._getCoord(e.x),s=this._getCoord(e.y),o=this._grid,a=o[s]=o[s]||{},r=a[n]=a[n]||[],i=L.Util.stamp(t);this._objectPoint[i]=e,r.push(t)},updateObject:function(t,e){this.removeObject(t),this.addObject(t,e)},removeObject:function(t,e){var i,u,n=this._getCoord(e.x),s=this._getCoord(e.y),o=this._grid,a=o[s]=o[s]||{},r=a[n]=a[n]||[];for(delete this._objectPoint[L.Util.stamp(t)],i=0,u=r.length;i<u;i++)if(r[i]===t)return r.splice(i,1),1===u&&delete a[n],!0},eachObject:function(t,e){var n,s,o,a,r,i,d=this._grid;for(n in d)for(s in r=d[n])for(o=0,a=(i=r[s]).length;o<a;o++)t.call(e,i[o])&&(o--,a--)},getNearObject:function(t){var s,o,a,r,i,u,d,_,e=this._getCoord(t.x),n=this._getCoord(t.y),f=this._objectPoint,c=this._sqCellSize,v=null;for(s=n-1;s<=n+1;s++)if(r=this._grid[s])for(o=e-1;o<=e+1;o++)if(i=r[o])for(a=0,u=i.length;a<u;a++)d=i[a],((_=this._sqDist(f[L.Util.stamp(d)],t))<c||_<=c&&null===v)&&(c=_,v=d);return v},_getCoord:function(t){var e=Math.floor(t/this._cellSize);return isFinite(e)?e:t},_sqDist:function(t,e){var n=e.x-t.x,s=e.y-t.y;return n*n+s*s}},L.QuickHull={getDistant:function(t,e){return(e[0].lng-e[1].lng)*(t.lat-e[0].lat)+(e[1].lat-e[0].lat)*(t.lng-e[0].lng)},findMostDistantPointFromBaseLine:function(t,e){var a,r,i,n=0,s=null,o=[];for(a=e.length-1;a>=0;a--)(i=this.getDistant(r=e[a],t))>0&&(o.push(r),i>n&&(n=i,s=r));return{maxPoint:s,newPoints:o}},buildConvexHull:function(t,e){var n=[],s=this.findMostDistantPointFromBaseLine(t,e);return s.maxPoint?n=(n=n.concat(this.buildConvexHull([t[0],s.maxPoint],s.newPoints))).concat(this.buildConvexHull([s.maxPoint,t[1]],s.newPoints)):[t[0]]},getConvexHull:function(t){var f,e=!1,n=!1,s=!1,o=!1,a=null,r=null,i=null,u=null,d=null,_=null;for(f=t.length-1;f>=0;f--){var c=t[f];(!1===e||c.lat>e)&&(a=c,e=c.lat),(!1===n||c.lat<n)&&(r=c,n=c.lat),(!1===s||c.lng>s)&&(i=c,s=c.lng),(!1===o||c.lng<o)&&(u=c,o=c.lng)}return n!==e?(_=r,d=a):(_=u,d=i),[].concat(this.buildConvexHull([_,d],t),this.buildConvexHull([d,_],t))}},L.MarkerCluster.include({getConvexHull:function(){var n,s,t=this.getAllChildMarkers(),e=[];for(s=t.length-1;s>=0;s--)n=t[s].getLatLng(),e.push(n);return L.QuickHull.getConvexHull(e)}}),L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var o,t=this.getAllChildMarkers(null,!0),s=this._group._map.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?o=this._group.options.spiderfyShapePositions(t.length,s):t.length>=this._circleSpiralSwitchover?o=this._generatePointsSpiral(t.length,s):(s.y+=10,o=this._generatePointsCircle(t.length,s)),this._animationSpiderfy(t,o)}},unspiderfy:function(t){this._group._inZoomAnimation||(this._animationUnspiderfy(t),this._group._spiderfied=null)},_generatePointsCircle:function(t,e){var r,i,s=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+t)/this._2PI,o=this._2PI/t,a=[];for(s=Math.max(s,35),a.length=t,r=0;r<t;r++)i=this._circleStartAngle+r*o,a[r]=new L.Point(e.x+s*Math.cos(i),e.y+s*Math.sin(i))._round();return a},_generatePointsSpiral:function(t,e){var u,n=this._group.options.spiderfyDistanceMultiplier,s=n*this._spiralLengthStart,o=n*this._spiralFootSeparation,a=n*this._spiralLengthFactor*this._2PI,r=0,i=[];for(i.length=t,u=t;u>=0;u--)u<t&&(i[u]=new L.Point(e.x+s*Math.cos(r),e.y+s*Math.sin(r))._round()),s+=a/(r+=o/s+5e-4*u);return i},_noanimationUnspiderfy:function(){var o,a,t=this._group,e=t._map,n=t._featureGroup,s=this.getAllChildMarkers(null,!0);for(t._ignoreMove=!0,this.setOpacity(1),a=s.length-1;a>=0;a--)n.removeLayer(o=s[a]),o._preSpiderfyLatlng&&(o.setLatLng(o._preSpiderfyLatlng),delete o._preSpiderfyLatlng),o.setZIndexOffset&&o.setZIndexOffset(0),o._spiderLeg&&(e.removeLayer(o._spiderLeg),delete o._spiderLeg);t.fire("unspiderfied",{cluster:this,markers:s}),t._ignoreMove=!1,t._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(t,e){var r,i,u,d,n=this._group,s=n._map,o=n._featureGroup,a=this._group.options.spiderLegPolylineOptions;for(n._ignoreMove=!0,r=0;r<t.length;r++)d=s.layerPointToLatLng(e[r]),i=t[r],u=new L.Polyline([this._latlng,d],a),s.addLayer(u),i._spiderLeg=u,i._preSpiderfyLatlng=i._latlng,i.setLatLng(d),i.setZIndexOffset&&i.setZIndexOffset(1e6),o.addLayer(i);this.setOpacity(.3),n._ignoreMove=!1,n.fire("spiderfied",{cluster:this,markers:t})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(t,e){var f,c,v,M,O,x,n=this,s=this._group,o=s._map,a=s._featureGroup,r=this._latlng,i=o.latLngToLayerPoint(r),u=L.Path.SVG,d=L.extend({},this._group.options.spiderLegPolylineOptions),_=d.opacity;for(void 0===_&&(_=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),u?(d.opacity=0,d.className=(d.className||"")+" leaflet-cluster-spider-leg"):d.opacity=_,s._ignoreMove=!0,f=0;f<t.length;f++)c=t[f],x=o.layerPointToLatLng(e[f]),v=new L.Polyline([r,x],d),o.addLayer(v),c._spiderLeg=v,u&&(O=(M=v._path).getTotalLength()+.1,M.style.strokeDasharray=O,M.style.strokeDashoffset=O),c.setZIndexOffset&&c.setZIndexOffset(1e6),c.clusterHide&&c.clusterHide(),a.addLayer(c),c._setPos&&c._setPos(i);for(s._forceLayout(),s._animationStart(),f=t.length-1;f>=0;f--)x=o.layerPointToLatLng(e[f]),(c=t[f])._preSpiderfyLatlng=c._latlng,c.setLatLng(x),c.clusterShow&&c.clusterShow(),u&&((M=(v=c._spiderLeg)._path).style.strokeDashoffset=0,v.setStyle({opacity:_}));this.setOpacity(.3),s._ignoreMove=!1,setTimeout(function(){s._animationEnd(),s.fire("spiderfied",{cluster:n,markers:t})},200)},_animationUnspiderfy:function(t){var u,d,_,f,c,v,e=this,n=this._group,s=n._map,o=n._featureGroup,a=t?s._latLngToNewLayerPoint(this._latlng,t.zoom,t.center):s.latLngToLayerPoint(this._latlng),r=this.getAllChildMarkers(null,!0),i=L.Path.SVG;for(n._ignoreMove=!0,n._animationStart(),this.setOpacity(1),d=r.length-1;d>=0;d--)(u=r[d])._preSpiderfyLatlng&&(u.closePopup(),u.setLatLng(u._preSpiderfyLatlng),delete u._preSpiderfyLatlng,v=!0,u._setPos&&(u._setPos(a),v=!1),u.clusterHide&&(u.clusterHide(),v=!1),v&&o.removeLayer(u),i&&(c=(f=(_=u._spiderLeg)._path).getTotalLength()+.1,f.style.strokeDashoffset=c,_.setStyle({opacity:0})));n._ignoreMove=!1,setTimeout(function(){var M=0;for(d=r.length-1;d>=0;d--)(u=r[d])._spiderLeg&&M++;for(d=r.length-1;d>=0;d--)(u=r[d])._spiderLeg&&(u.clusterShow&&u.clusterShow(),u.setZIndexOffset&&u.setZIndexOffset(0),M>1&&o.removeLayer(u),s.removeLayer(u._spiderLeg),delete u._spiderLeg);n._animationEnd(),n.fire("unspiderfied",{cluster:e,markers:r})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(t){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(t))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(t){this._spiderfied&&this._spiderfied.unspiderfy(t)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(t){t._spiderLeg&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow(),t.setZIndexOffset&&t.setZIndexOffset(0),this._map.removeLayer(t._spiderLeg),delete t._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(t){return t?t instanceof L.MarkerClusterGroup?t=t._topClusterLevel.getAllChildMarkers():t instanceof L.LayerGroup?t=t._layers:t instanceof L.MarkerCluster?t=t.getAllChildMarkers():t instanceof L.Marker&&(t=[t]):t=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(t),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(t),this},_flagParentsIconsNeedUpdate:function(t){var e,n;for(e in t)for(n=t[e].__parent;n;)n._iconNeedsUpdate=!0,n=n.__parent},_refreshSingleMarkerModeMarkers:function(t){var e,n;for(e in t)this.hasLayer(n=t[e])&&n.setIcon(this._overrideMarkerIcon(n))}}),L.Marker.include({refreshIconOptions:function(t,e){var n=this.options.icon;return L.setOptions(n,t),this.setIcon(n),e&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),m.MarkerClusterGroup=S,m.MarkerCluster=b,Object.defineProperty(m,"__esModule",{value:!0})}(Z)}}]);